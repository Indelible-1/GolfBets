{"version":3,"sources":["../../../../src/app/match/%5Bid%5D/scorecard/page.tsx","../../../../src/components/scorecard/HoleInput.tsx","../../../../src/components/scorecard/RunningTotal.tsx","../../../../src/components/scorecard/Scorecard.tsx","../../../../src/hooks/useScores.ts","../../../../src/lib/firestore/scores.ts"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport Link from 'next/link'\nimport { Screen, Header } from '@/components/layout'\nimport { Card, Button, Modal } from '@/components/ui'\nimport { Scorecard } from '@/components/scorecard'\nimport { ProtectedRoute } from '@/components/auth'\nimport { useAuth } from '@/hooks/useAuth'\nimport { useMatch } from '@/hooks/useMatch'\nimport { useScores, useParticipantScores } from '@/hooks/useScores'\nimport { createOrUpdateScore } from '@/lib/firestore/scores'\nimport { updateMatchStatus } from '@/lib/firestore/matches'\n\ninterface ScorecardPageProps {\n  params: { id: string }\n}\n\nexport default function ScorecardPage({ params }: ScorecardPageProps) {\n  const matchId = params.id\n  const { user } = useAuth()\n  const { match, loading: matchLoading } = useMatch(matchId)\n  const { scores: allScores, loading: scoresLoading } = useScores(matchId)\n  const { scores: userScores } = useParticipantScores(matchId, user?.id || null)\n  const [savingScores, setSavingScores] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [completeModalOpen, setCompleteModalOpen] = useState(false)\n\n  if (matchLoading) {\n    return (\n      <ProtectedRoute>\n        <Screen>\n          <Header title=\"Scorecard\" />\n          <div className=\"p-4 flex items-center justify-center h-96\">\n            <div className=\"text-center space-y-2\">\n              <div className=\"animate-spin text-4xl\">⛳</div>\n              <p className=\"text-gray-500\">Loading match...</p>\n            </div>\n          </div>\n        </Screen>\n      </ProtectedRoute>\n    )\n  }\n\n  if (!match || !user) {\n    return (\n      <ProtectedRoute>\n        <Screen>\n          <Header title=\"Scorecard\" />\n          <div className=\"p-4\">\n            <Card variant=\"outlined\" className=\"bg-red-50 border-red-200\">\n              <p className=\"text-red-700 text-sm\">Match not found or not authenticated</p>\n            </Card>\n          </div>\n        </Screen>\n      </ProtectedRoute>\n    )\n  }\n\n  // Build current user's scores map\n  const currentUserScoresMap: Record<number, number | undefined> = {}\n  userScores.forEach((score) => {\n    currentUserScoresMap[score.holeNumber] = score.strokes\n  })\n\n  // Build all participants' scores map\n  const allParticipantsScoresMap: Record<string, Record<number, number | undefined>> = {}\n  match.participantIds.forEach((id) => {\n    allParticipantsScoresMap[id] = {}\n  })\n  allScores.forEach((score) => {\n    if (!allParticipantsScoresMap[score.participantId]) {\n      allParticipantsScoresMap[score.participantId] = {}\n    }\n    allParticipantsScoresMap[score.participantId][score.holeNumber] = score.strokes\n  })\n\n  const handleScoreChange = async (hole: number, score: number | undefined) => {\n    if (!user) return\n\n    setSavingScores(true)\n    setError(null)\n\n    try {\n      if (score !== undefined) {\n        await createOrUpdateScore(\n          matchId,\n          user.id,\n          {\n            holeNumber: hole,\n            strokes: score,\n            enteredBy: user.id,\n            deviceId: 'web', // Could be enhanced with device detection\n          }\n        )\n      }\n\n      // Update local state\n      currentUserScoresMap[hole] = score\n    } catch (err) {\n      console.error('Failed to save score:', err)\n      setError(err instanceof Error ? err.message : 'Failed to save score')\n    } finally {\n      setSavingScores(false)\n    }\n  }\n\n  const handleCompleteMatch = async () => {\n    setSavingScores(true)\n    setError(null)\n\n    try {\n      await updateMatchStatus(matchId, 'completed')\n      setCompleteModalOpen(false)\n      // Redirect to results page\n      // Router would be used here, but this is handled by the modal\n    } catch (err) {\n      console.error('Failed to complete match:', err)\n      setError(err instanceof Error ? err.message : 'Failed to complete match')\n    } finally {\n      setSavingScores(false)\n    }\n  }\n\n  const totalHolesEntered = Object.values(currentUserScoresMap).filter((s) => s !== undefined).length\n  const roundComplete = totalHolesEntered === match.holes\n\n  return (\n    <ProtectedRoute>\n      <Screen padBottom>\n        <Header\n          title={match.courseName}\n          subtitle=\"Enter Scores\"\n        />\n\n        <div className=\"p-4 pb-24 space-y-6\">\n          {/* Error Banner */}\n          {error && (\n            <Card variant=\"outlined\" className=\"bg-red-50 border-red-200 p-4\">\n              <p className=\"text-red-700 text-sm\">{error}</p>\n            </Card>\n          )}\n\n          {/* Scorecard */}\n          {!scoresLoading ? (\n            <Scorecard\n              totalHoles={match.holes}\n              currentUserScores={currentUserScoresMap}\n              allParticipantScores={allParticipantsScoresMap}\n              participantNames={match.participantIds.reduce(\n                (acc, id) => {\n                  acc[id] = user.id === id ? user.displayName : `Player ${id.slice(0, 6)}`\n                  return acc\n                },\n                {} as Record<string, string>\n              )}\n              onScoreChange={handleScoreChange}\n              loading={savingScores}\n            />\n          ) : (\n            <div className=\"text-center py-8\">\n              <div className=\"animate-spin text-4xl mb-2\">⛳</div>\n              <p className=\"text-gray-500\">Loading scores...</p>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"space-y-3\">\n            {roundComplete && match.status === 'active' && (\n              <>\n                <Button\n                  onClick={() => setCompleteModalOpen(true)}\n                  loading={savingScores}\n                  disabled={savingScores}\n                  fullWidth\n                >\n                  Complete Round\n                </Button>\n                <Link href={`/match/${matchId}`} className=\"block\">\n                  <Button variant=\"secondary\" fullWidth>\n                    Back to Match\n                  </Button>\n                </Link>\n              </>\n            )}\n\n            {match.status === 'completed' && (\n              <Link href={`/match/${matchId}/results`} className=\"block\">\n                <Button fullWidth>\n                  View Results\n                </Button>\n              </Link>\n            )}\n\n            {!roundComplete && (\n              <Link href={`/match/${matchId}`} className=\"block\">\n                <Button variant=\"secondary\" fullWidth>\n                  Back to Match\n                </Button>\n              </Link>\n            )}\n          </div>\n        </div>\n\n        {/* Complete Match Confirmation Modal */}\n        <Modal\n          isOpen={completeModalOpen}\n          onClose={() => setCompleteModalOpen(false)}\n          title=\"Complete Round?\"\n          size=\"md\"\n        >\n          <div className=\"space-y-4\">\n            <p className=\"text-gray-600 text-sm\">\n              Are you sure you want to complete this round? You can still view and modify scores afterward.\n            </p>\n\n            <div className=\"bg-gray-50 p-3 rounded-lg space-y-2\">\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-gray-600\">Course</span>\n                <span className=\"font-semibold text-gray-900\">{match.courseName}</span>\n              </div>\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-gray-600\">Holes</span>\n                <span className=\"font-semibold text-gray-900\">{match.holes}</span>\n              </div>\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-gray-600\">Players</span>\n                <span className=\"font-semibold text-gray-900\">{match.participantIds.length}</span>\n              </div>\n            </div>\n\n            <div className=\"flex gap-3 pt-2\">\n              <Button\n                variant=\"secondary\"\n                onClick={() => setCompleteModalOpen(false)}\n                disabled={savingScores}\n                fullWidth\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={handleCompleteMatch}\n                loading={savingScores}\n                disabled={savingScores}\n                fullWidth\n              >\n                Complete\n              </Button>\n            </div>\n          </div>\n        </Modal>\n      </Screen>\n    </ProtectedRoute>\n  )\n}\n","'use client'\n\nimport { cn } from '@/lib/utils'\n\ninterface HoleInputProps {\n  holeNumber: number\n  par: number\n  score?: number\n  onScoreChange: (score: number | undefined) => void\n  disabled?: boolean\n  className?: string\n}\n\nexport function HoleInput({\n  holeNumber,\n  par,\n  score,\n  onScoreChange,\n  disabled = false,\n  className,\n}: HoleInputProps) {\n  const scoreToParDiff = score !== undefined ? score - par : 0\n  const scoreColor = score === undefined ? 'text-gray-900' : scoreToParDiff < 0 ? 'text-fairway-600' : scoreToParDiff > 0 ? 'text-red-600' : 'text-gray-900'\n  const scoreBg = score === undefined ? 'bg-gray-100' : scoreToParDiff < 0 ? 'bg-fairway-50' : scoreToParDiff > 0 ? 'bg-red-50' : 'bg-white'\n\n  const handleMinus = () => {\n    if (score === undefined) {\n      onScoreChange(par - 1)\n    } else if (score > 1) {\n      onScoreChange(score - 1)\n    }\n  }\n\n  const handlePlus = () => {\n    if (score === undefined) {\n      onScoreChange(par + 1)\n    } else if (score < 20) {\n      onScoreChange(score + 1)\n    }\n  }\n\n  const formatScore = (s?: number) => (s === undefined ? '-' : s.toString())\n  const formatToPar = (s?: number) => {\n    if (s === undefined) return ''\n    const diff = s - par\n    if (diff === 0) return 'E'\n    if (diff > 0) return `+${diff}`\n    return `${diff}`\n  }\n\n  return (\n    <div\n      className={cn(\n        'flex flex-col items-center gap-2 p-3 rounded-lg border border-gray-200',\n        'tap-target',\n        disabled && 'opacity-50 cursor-not-allowed',\n        className\n      )}\n    >\n      {/* Hole Number Badge */}\n      <div className=\"flex items-center gap-2 w-full justify-between\">\n        <div className=\"flex items-center gap-1\">\n          <span className=\"text-xs font-semibold text-gray-600 uppercase\">Hole</span>\n          <span className=\"text-sm font-bold text-gray-900\">{holeNumber}</span>\n        </div>\n        <span className=\"text-xs font-semibold text-gray-600\">Par {par}</span>\n      </div>\n\n      {/* Score Display */}\n      <div className={cn('w-full h-16 rounded-lg flex items-center justify-center', 'border-2 border-gray-300 transition-all', scoreBg, scoreColor)}>\n        <div className=\"flex flex-col items-center\">\n          <span className=\"text-2xl font-bold\">{formatScore(score)}</span>\n          {score !== undefined && <span className=\"text-xs font-semibold\">{formatToPar(score)}</span>}\n        </div>\n      </div>\n\n      {/* +/- Buttons */}\n      <div className=\"flex gap-2 w-full\">\n        <button\n          onClick={handleMinus}\n          disabled={disabled || (score === undefined && par <= 1) || (score !== undefined && score <= 1)}\n          className={cn(\n            'flex-1 h-12 rounded-lg font-bold text-lg transition-colors',\n            'tap-target',\n            'border-2 border-gray-300 bg-white text-gray-900',\n            'hover:bg-gray-50 hover:border-gray-400',\n            'disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white disabled:hover:border-gray-300',\n            'focus:outline-none focus:ring-2 focus:ring-fairway-500 focus:ring-offset-2'\n          )}\n          aria-label={`Decrease score for hole ${holeNumber}`}\n        >\n          −\n        </button>\n        <button\n          onClick={handlePlus}\n          disabled={disabled || (score !== undefined && score >= 20)}\n          className={cn(\n            'flex-1 h-12 rounded-lg font-bold text-lg transition-colors',\n            'tap-target',\n            'border-2 border-gray-300 bg-white text-gray-900',\n            'hover:bg-gray-50 hover:border-gray-400',\n            'disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white disabled:hover:border-gray-300',\n            'focus:outline-none focus:ring-2 focus:ring-fairway-500 focus:ring-offset-2'\n          )}\n          aria-label={`Increase score for hole ${holeNumber}`}\n        >\n          +\n        </button>\n      </div>\n    </div>\n  )\n}\n","'use client'\n\nimport { cn } from '@/lib/utils'\n\ninterface RunningTotalProps {\n  currentHole: number\n  totalHoles: number\n  totalStrokes?: number\n  totalPar: number\n  className?: string\n}\n\nexport function RunningTotal({\n  currentHole,\n  totalHoles,\n  totalStrokes,\n  totalPar,\n  className,\n}: RunningTotalProps) {\n  const toParDiff = totalStrokes !== undefined ? totalStrokes - totalPar : 0\n  const toParColor =\n    totalStrokes === undefined\n      ? 'text-gray-600'\n      : toParDiff < 0\n        ? 'text-fairway-600'\n        : toParDiff > 0\n          ? 'text-red-600'\n          : 'text-gray-900'\n\n  const formatToPar = () => {\n    if (totalStrokes === undefined) return 'E'\n    if (toParDiff === 0) return 'E'\n    if (toParDiff > 0) return `+${toParDiff}`\n    return `${toParDiff}`\n  }\n\n  return (\n    <div\n      className={cn(\n        'grid grid-cols-3 gap-2 p-4 bg-gray-50 rounded-lg border border-gray-200',\n        className\n      )}\n    >\n      {/* Thru X Holes */}\n      <div className=\"flex flex-col items-center gap-1\">\n        <span className=\"text-xs text-gray-600 uppercase font-semibold\">Thru</span>\n        <span className=\"text-xl font-bold text-gray-900\">\n          {currentHole}/{totalHoles}\n        </span>\n      </div>\n\n      {/* Total Strokes */}\n      <div className=\"flex flex-col items-center gap-1\">\n        <span className=\"text-xs text-gray-600 uppercase font-semibold\">Total</span>\n        <span className=\"text-xl font-bold text-gray-900\">\n          {totalStrokes === undefined ? '-' : totalStrokes}\n        </span>\n      </div>\n\n      {/* To Par */}\n      <div className=\"flex flex-col items-center gap-1\">\n        <span className=\"text-xs text-gray-600 uppercase font-semibold\">To Par</span>\n        <span className={cn('text-xl font-bold', toParColor)}>\n          {formatToPar()}\n        </span>\n      </div>\n    </div>\n  )\n}\n","'use client'\n\nimport { Card } from '@/components/ui'\nimport { HoleInput } from './HoleInput'\nimport { RunningTotal } from './RunningTotal'\nimport { cn } from '@/lib/utils'\n\ninterface ScorecardProps {\n  totalHoles: 9 | 18\n  currentUserScores: Record<number, number | undefined>\n  allParticipantScores: Record<string, Record<number, number | undefined>>\n  participantNames: Record<string, string>\n  onScoreChange: (hole: number, score: number | undefined) => Promise<void>\n  loading?: boolean\n  className?: string\n}\n\nconst DEFAULT_PARS_18 = [4, 4, 3, 5, 4, 4, 3, 4, 5, 4, 4, 3, 5, 4, 4, 3, 4, 5]\nconst DEFAULT_PARS_9 = [4, 4, 3, 5, 4, 4, 3, 4, 5]\n\nexport function Scorecard({\n  totalHoles,\n  currentUserScores,\n  allParticipantScores,\n  participantNames,\n  onScoreChange,\n  loading = false,\n  className,\n}: ScorecardProps) {\n  const pars = totalHoles === 18 ? DEFAULT_PARS_18 : DEFAULT_PARS_9\n  const totalPar = pars.reduce((sum, par) => sum + par, 0)\n\n  // Calculate running totals\n  const currentUserTotal = Object.values(currentUserScores).reduce<number>(\n    (sum, score) => sum + (score || 0),\n    0\n  ) || undefined\n  const holesEntered = Object.values(currentUserScores).filter((s) => s !== undefined).length\n\n  // Get current hole (next to enter)\n  const currentHole = holesEntered + 1\n\n  // Build leaderboard\n  const leaderboard = Object.entries(allParticipantScores)\n    .map(([userId, scores]) => {\n      const total = Object.values(scores).reduce<number>((sum, score) => sum + (score || 0), 0) || undefined\n      const entered = Object.values(scores).filter((s) => s !== undefined).length\n      return {\n        userId,\n        name: participantNames[userId] || `Player ${userId.slice(0, 6)}`,\n        total: total || 0,\n        entered,\n        toPar: total !== undefined ? total - (pars.slice(0, entered).reduce((s, p) => s + p, 0) || totalPar) : 0,\n      }\n    })\n    .sort((a, b) => {\n      // Sort by: most holes entered, then by score\n      if (a.entered !== b.entered) return b.entered - a.entered\n      return a.total - b.total\n    })\n\n  const handleScoreChange = async (hole: number, score: number | undefined) => {\n    await onScoreChange(hole, score)\n  }\n\n  return (\n    <div className={cn('space-y-6', className)}>\n      {/* Running Total */}\n      <RunningTotal\n        currentHole={currentHole}\n        totalHoles={totalHoles}\n        totalStrokes={currentUserTotal}\n        totalPar={totalPar}\n      />\n\n      {/* Holes Grid */}\n      <div className=\"space-y-4\">\n        <h3 className=\"font-semibold text-gray-900 text-sm uppercase\">Scorecard</h3>\n        <div className=\"grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-4\">\n          {pars.map((par, index) => {\n            const holeNumber = index + 1\n            const score = currentUserScores[holeNumber]\n            return (\n              <HoleInput\n                key={holeNumber}\n                holeNumber={holeNumber}\n                par={par}\n                score={score}\n                onScoreChange={(newScore) => handleScoreChange(holeNumber, newScore)}\n                disabled={loading}\n              />\n            )\n          })}\n        </div>\n      </div>\n\n      {/* Leaderboard */}\n      <div className=\"space-y-3\">\n        <h3 className=\"font-semibold text-gray-900 text-sm uppercase\">Leaderboard</h3>\n        <div className=\"space-y-2\">\n          {leaderboard.length > 0 ? (\n            leaderboard.map((player, index) => (\n              <Card\n                key={player.userId}\n                variant=\"outlined\"\n                className={cn(\n                  'p-3 flex items-center justify-between',\n                  'tap-target',\n                  index === 0 && 'border-2 border-fairway-400 bg-fairway-50'\n                )}\n              >\n                <div className=\"flex items-center gap-3 flex-1\">\n                  <div className=\"text-center\">\n                    <div className=\"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center\">\n                      <span className=\"text-xs font-bold text-gray-600\">{index + 1}</span>\n                    </div>\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"font-medium text-gray-900 text-sm\">{player.name}</p>\n                    <p className=\"text-xs text-gray-500\">{player.entered} holes entered</p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"text-right\">\n                    <p className=\"text-lg font-bold text-gray-900\">{player.total}</p>\n                    <p\n                      className={cn(\n                        'text-xs font-semibold',\n                        player.entered === totalHoles && player.toPar < 0\n                          ? 'text-fairway-600'\n                          : player.entered === totalHoles && player.toPar > 0\n                            ? 'text-red-600'\n                            : 'text-gray-600'\n                      )}\n                    >\n                      {player.entered === totalHoles\n                        ? player.toPar === 0\n                          ? 'E'\n                          : player.toPar > 0\n                            ? `+${player.toPar}`\n                            : player.toPar\n                        : '—'}\n                    </p>\n                  </div>\n                </div>\n              </Card>\n            ))\n          ) : (\n            <Card variant=\"outlined\" className=\"p-4 text-center\">\n              <p className=\"text-gray-500 text-sm\">No scores entered yet</p>\n            </Card>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","'use client'\n\nimport { useEffect, useState } from 'react'\nimport { onSnapshot } from 'firebase/firestore'\nimport { Score } from '@/types'\nimport { scoresCollection } from '@/lib/firestore/collections'\n\ninterface UseScoresReturn {\n  scores: Score[]\n  loading: boolean\n  error: Error | null\n}\n\n/**\n * Hook to fetch all scores for a match with real-time updates\n * Automatically subscribes to scores subcollection\n *\n * @param matchId Match ID to fetch scores for\n * @returns Scores array, loading state, and error\n */\nexport function useScores(matchId: string | null): UseScoresReturn {\n  const [scores, setScores] = useState<Score[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<Error | null>(null)\n\n  useEffect(() => {\n    if (!matchId) {\n      return\n    }\n\n    try {\n      const unsubscribe = onSnapshot(\n        scoresCollection(matchId),\n        (snapshot) => {\n          const scoresData = snapshot.docs.map((doc) => doc.data())\n          // Sort by participant ID, then hole number\n          const sorted = scoresData.sort((a, b) => {\n            if (a.participantId !== b.participantId) {\n              return a.participantId.localeCompare(b.participantId)\n            }\n            return a.holeNumber - b.holeNumber\n          })\n          setScores(sorted)\n          setError(null)\n          setLoading(false)\n        },\n        (err) => {\n          console.error('Error subscribing to scores:', err)\n          setError(err instanceof Error ? err : new Error('Unknown error'))\n          setLoading(false)\n        },\n      )\n\n      return () => unsubscribe()\n    } catch {\n      // Silently catch setup errors - error is already handled in onSnapshot error handler\n    }\n  }, [matchId])\n\n  return {\n    scores,\n    loading,\n    error,\n  }\n}\n\n/**\n * Hook to fetch scores for a specific participant\n *\n * @param matchId Match ID\n * @param participantId Participant ID to filter by\n * @returns Scores for participant, loading state, and error\n */\nexport function useParticipantScores(\n  matchId: string | null,\n  participantId: string | null,\n): UseScoresReturn {\n  const [scores, setScores] = useState<Score[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<Error | null>(null)\n\n  useEffect(() => {\n    if (!matchId || !participantId) {\n      return\n    }\n\n    try {\n      const unsubscribe = onSnapshot(\n        scoresCollection(matchId),\n        (snapshot) => {\n          const scoresData = snapshot.docs\n            .map((doc) => doc.data())\n            .filter((score) => score.participantId === participantId)\n            .sort((a, b) => a.holeNumber - b.holeNumber)\n          setScores(scoresData)\n          setError(null)\n          setLoading(false)\n        },\n        (err) => {\n          console.error('Error subscribing to participant scores:', err)\n          setError(err instanceof Error ? err : new Error('Unknown error'))\n          setLoading(false)\n        },\n      )\n\n      return () => unsubscribe()\n    } catch {\n      // Silently catch setup errors - error is already handled in onSnapshot error handler\n    }\n  }, [matchId, participantId])\n\n  return {\n    scores,\n    loading,\n    error,\n  }\n}\n","import { getDoc, getDocs, runTransaction } from 'firebase/firestore'\nimport { db } from '@/lib/firebase'\nimport { Score } from '@/types'\nimport { scoreDoc, scoresCollection } from './collections'\n\n// ============ READ ============\n\n/**\n * Fetch score document by composite ID (participantId_holeNumber)\n */\nexport async function getScore(\n  matchId: string,\n  scoreId: string,\n): Promise<Score | null> {\n  try {\n    const snapshot = await getDoc(scoreDoc(matchId, scoreId))\n    return snapshot.exists() ? snapshot.data() : null\n  } catch (error) {\n    console.error('Error fetching score:', error)\n    throw error\n  }\n}\n\n/**\n * Get all scores for a specific hole across all participants\n */\nexport async function getScoresForHole(\n  matchId: string,\n  holeNumber: number,\n): Promise<Score[]> {\n  try {\n    const snapshot = await getDocs(scoresCollection(matchId))\n    return snapshot.docs\n      .map((doc) => doc.data())\n      .filter((score) => score.holeNumber === holeNumber)\n  } catch (error) {\n    console.error('Error fetching scores for hole:', error)\n    throw error\n  }\n}\n\n/**\n * Get all scores for a specific participant (their scorecard)\n */\nexport async function getScoresForParticipant(\n  matchId: string,\n  participantId: string,\n): Promise<Score[]> {\n  try {\n    const snapshot = await getDocs(scoresCollection(matchId))\n    const scores = snapshot.docs\n      .map((doc) => doc.data())\n      .filter((score) => score.participantId === participantId)\n    return scores.sort((a, b) => a.holeNumber - b.holeNumber)\n  } catch (error) {\n    console.error('Error fetching participant scores:', error)\n    throw error\n  }\n}\n\n/**\n * Get all scores for a match\n */\nexport async function getAllMatchScores(matchId: string): Promise<Score[]> {\n  try {\n    const snapshot = await getDocs(scoresCollection(matchId))\n    const scores = snapshot.docs.map((doc) => doc.data())\n    return scores.sort((a, b) => {\n      if (a.participantId !== b.participantId) {\n        return a.participantId.localeCompare(b.participantId)\n      }\n      return a.holeNumber - b.holeNumber\n    })\n  } catch (error) {\n    console.error('Error fetching all match scores:', error)\n    throw error\n  }\n}\n\n// ============ CREATE/UPDATE ============\n\n/**\n * Create or update score with optimistic locking to prevent conflicts\n *\n * Key features:\n * - Composite ID: `participantId_holeNumber` prevents duplicates\n * - Version field prevents concurrent update conflicts\n * - deviceId tracks which device entered the score (for offline sync)\n * - syncedAt tracks when it was successfully persisted\n *\n * @param matchId Match ID\n * @param participantId Participant ID\n * @param data Score data (strokes, putts, fairway, GIR)\n * @param expectedVersion Version to compare against (for optimistic locking)\n */\nexport async function createOrUpdateScore(\n  matchId: string,\n  participantId: string,\n  data: {\n    holeNumber: number\n    strokes: number\n    putts?: number | null\n    fairwayHit?: boolean | null\n    greenInRegulation?: boolean | null\n    enteredBy: string\n    deviceId: string\n  },\n  expectedVersion?: number,\n): Promise<Score> {\n  const scoreId = `${participantId}_${data.holeNumber}`\n\n  try {\n    const result = await runTransaction(db, async (transaction) => {\n      const scoreRef = scoreDoc(matchId, scoreId)\n      const snapshot = await transaction.get(scoreRef)\n      const now = new Date()\n\n      if (snapshot.exists()) {\n        // Update existing score\n        const existingScore = snapshot.data()\n\n        // Optimistic locking: check version matches\n        if (expectedVersion !== undefined && existingScore.version !== expectedVersion) {\n          throw new Error(\n            `Version mismatch: expected ${expectedVersion}, got ${existingScore.version}`,\n          )\n        }\n\n        const updatedScore: Score = {\n          ...existingScore,\n          strokes: data.strokes,\n          putts: data.putts ?? existingScore.putts,\n          fairwayHit: data.fairwayHit ?? existingScore.fairwayHit,\n          greenInRegulation: data.greenInRegulation ?? existingScore.greenInRegulation,\n          enteredBy: data.enteredBy,\n          updatedAt: now,\n          version: existingScore.version + 1,\n          syncedAt: now,\n        }\n\n        const updateData: Record<string, unknown> = {\n          strokes: updatedScore.strokes,\n          putts: updatedScore.putts,\n          fairwayHit: updatedScore.fairwayHit,\n          greenInRegulation: updatedScore.greenInRegulation,\n          enteredBy: updatedScore.enteredBy,\n          updatedAt: updatedScore.updatedAt,\n          version: updatedScore.version,\n          syncedAt: updatedScore.syncedAt,\n        }\n        transaction.update(scoreRef, updateData)\n        return updatedScore\n      } else {\n        // Create new score\n        const newScore: Score = {\n          id: scoreId,\n          participantId,\n          holeNumber: data.holeNumber,\n          strokes: data.strokes,\n          putts: data.putts ?? null,\n          fairwayHit: data.fairwayHit ?? null,\n          greenInRegulation: data.greenInRegulation ?? null,\n          enteredBy: data.enteredBy,\n          createdAt: now,\n          updatedAt: now,\n          version: 1,\n          deviceId: data.deviceId,\n          syncedAt: now,\n        }\n\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        transaction.set(scoreRef, newScore as any)\n        return newScore\n      }\n    })\n\n    return result\n  } catch (error) {\n    console.error('Error creating/updating score:', error)\n    throw error\n  }\n}\n\n/**\n * Batch update scores (useful for offline sync)\n * Each score must include its current version for conflict detection\n */\nexport async function batchUpdateScores(\n  matchId: string,\n  scores: Array<Score & { expectedVersion: number }>,\n): Promise<void> {\n  try {\n    await runTransaction(db, async (transaction) => {\n      for (const scoreItem of scores) {\n        const { expectedVersion } = scoreItem\n        const scoreRef = scoreDoc(matchId, scoreItem.id)\n        const snapshot = await transaction.get(scoreRef)\n\n        if (snapshot.exists()) {\n          const existing = snapshot.data()\n          if (existing.version !== expectedVersion) {\n            throw new Error(\n              `Version mismatch for ${scoreItem.id}: expected ${expectedVersion}, got ${existing.version}`,\n            )\n          }\n        }\n\n        const updateData: Record<string, unknown> = {\n          version: expectedVersion + 1,\n          updatedAt: new Date(),\n          syncedAt: new Date(),\n        }\n        transaction.update(scoreRef, updateData)\n      }\n    })\n  } catch (error) {\n    console.error('Error batch updating scores:', error)\n    throw error\n  }\n}\n"],"names":[],"mappings":"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"}