(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54338,75076,50136,e=>{"use strict";let t;var a=e.i(71645);e.i(51718);var s=e.i(18357),r=e.i(59141);e.i(36180);var n=e.i(98925);let i={toFirestore:e=>({...e,createdAt:n.Timestamp.fromDate(e.createdAt),updatedAt:n.Timestamp.fromDate(e.updatedAt),lastActiveAt:n.Timestamp.fromDate(e.lastActiveAt)}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate(),lastActiveAt:t.lastActiveAt.toDate()}}},o={toFirestore:e=>({...e,createdAt:n.Timestamp.fromDate(e.createdAt),updatedAt:n.Timestamp.fromDate(e.updatedAt),startedAt:e.startedAt?n.Timestamp.fromDate(e.startedAt):null,completedAt:e.completedAt?n.Timestamp.fromDate(e.completedAt):null,teeTime:n.Timestamp.fromDate(e.teeTime)}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate(),startedAt:t.startedAt?.toDate()??null,completedAt:t.completedAt?.toDate()??null,teeTime:t.teeTime.toDate()}}},c={toFirestore:e=>({...e,invitedAt:n.Timestamp.fromDate(e.invitedAt),confirmedAt:e.confirmedAt?n.Timestamp.fromDate(e.confirmedAt):null}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,invitedAt:t.invitedAt.toDate(),confirmedAt:t.confirmedAt?.toDate()??null}}},l={toFirestore:e=>({...e,createdAt:n.Timestamp.fromDate(e.createdAt),updatedAt:n.Timestamp.fromDate(e.updatedAt),syncedAt:e.syncedAt?n.Timestamp.fromDate(e.syncedAt):null}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate(),syncedAt:t.syncedAt?.toDate()??null}}},d={toFirestore:e=>({...e,createdAt:n.Timestamp.fromDate(e.createdAt)}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,createdAt:t.createdAt.toDate()}}};function u(){return t||(t=(0,n.getFirestore)()),t}let m=e=>(0,n.doc)((0,n.collection)(u(),"users"),e).withConverter(i);async function h(e){try{let t=await (0,n.getDoc)(m(e));return t.exists()?t.data():null}catch(e){throw console.error("Error fetching user:",e),e}}async function p(e,t){let a=new Date,s={id:e,displayName:t.displayName,email:t.email,avatarUrl:null,handicapIndex:null,homeClub:null,defaultTeeBox:"blue",notificationsEnabled:!0,createdAt:a,updatedAt:a,lastActiveAt:a};try{return await (0,n.setDoc)(m(e),s),s}catch(e){throw console.error("Error creating user:",e),e}}async function x(e,t){try{await (0,n.updateDoc)(m(e),{...t,updatedAt:new Date})}catch(e){throw console.error("Error updating user:",e),e}}async function g(e){try{await (0,n.updateDoc)(m(e),{lastActiveAt:new Date})}catch(e){throw console.error("Error updating user activity:",e),e}}function y(){let[e,t]=(0,a.useState)(null),[n,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0),[l,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=(0,s.onAuthStateChanged)(r.auth,async e=>{try{if(t(e),e){let t=await h(e.uid);if(t)await g(e.uid);else{let a=e.displayName||e.email||"User",s=e.email||"";t=await p(e.uid,{displayName:a,email:s})}i(t),d(null)}else i(null),d(null);c(!1)}catch(e){d(e instanceof Error?e:Error("Unknown auth error")),c(!1)}});return()=>e()},[]),{firebaseUser:e,user:n,loading:o,error:l}}e.s(["betDoc",0,(e,t)=>(0,n.doc)((0,n.collection)(u(),`matches/${e}/bets`),t).withConverter(d),"matchDoc",0,e=>(0,n.doc)((0,n.collection)(u(),"matches"),e).withConverter(o),"matchesCollection",0,()=>(0,n.collection)(u(),"matches").withConverter(o),"participantsCollection",0,e=>(0,n.collection)(u(),`matches/${e}/participants`).withConverter(c),"scoreDoc",0,(e,t)=>(0,n.doc)((0,n.collection)(u(),`matches/${e}/scores`),t).withConverter(l),"scoresCollection",0,e=>(0,n.collection)(u(),`matches/${e}/scores`).withConverter(l),"userDoc",0,m],75076),e.s(["createUser",()=>p,"getUser",()=>h,"updateUser",()=>x,"updateUserActivity",()=>g],50136),e.s(["useAuth",()=>y],54338)},64649,48010,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(54338);e.i(84004);var n=e.i(66085);function i({children:e}){let{user:i,loading:o}=(0,r.useAuth)(),c=(0,s.useRouter)();return((0,a.useEffect)(()=>{o||i||c.push("/login")},[i,o,c]),o)?(0,t.jsx)(n.Screen,{className:"flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin text-4xl mb-4",children:"⛳"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Loading..."})]})}):i?(0,t.jsx)(t.Fragment,{children:e}):null}e.s(["ProtectedRoute",()=>i],48010),e.s([],64649)},34051,e=>{"use strict";e.i(36180);var t=e.i(98925),a=e.i(75076);async function s(e){try{let s=await (0,t.getDoc)((0,a.matchDoc)(e));return s.exists()?s.data():null}catch(e){throw console.error("Error fetching match:",e),e}}async function r(e,s){try{let r=(0,t.query)((0,a.matchesCollection)(),(0,t.where)("participantIds","array-contains",e)),n=(await (0,t.getDocs)(r)).docs.map(e=>e.data());return s&&(n=n.filter(e=>e.status===s)),n.sort((e,t)=>t.teeTime.getTime()-e.teeTime.getTime())}catch(e){throw console.error("Error fetching user matches:",e),e}}async function n(e,s){let r=new Date,n=`match_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:n,courseName:s.courseName,courseId:s.courseId||null,teeTime:s.teeTime,holes:s.holes||18,status:"pending",currentHole:null,createdBy:e,scorerId:e,participantIds:[e],createdAt:r,updatedAt:r,startedAt:null,completedAt:null,version:1};try{return await (0,t.setDoc)((0,a.matchDoc)(n),i),i}catch(e){throw console.error("Error creating match:",e),e}}async function i(e,s){try{let r={status:s,updatedAt:new Date};"active"===s?r.startedAt=new Date:"completed"===s&&(r.completedAt=new Date),await (0,t.updateDoc)((0,a.matchDoc)(e),r)}catch(e){throw console.error("Error updating match status:",e),e}}e.s(["createMatch",()=>n,"getMatch",()=>s,"getUserMatches",()=>r,"updateMatchStatus",()=>i])},94968,41566,33330,e=>{"use strict";var t=e.i(43476),a=e.i(22016);e.i(16787);var s=e.i(39964),r=e.i(96640),n=e.i(91285);function i({match:e,className:i}){var o;let c;return(0,t.jsx)(a.default,{href:`/match/${e.id}`,children:(0,t.jsxs)(s.Card,{variant:"outlined",className:(0,n.cn)("hover:border-fairway-300 transition-colors cursor-pointer",i),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:e.courseName}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:(c=(o=e.teeTime)instanceof Date?o:"object"==typeof o&&null!==o&&"toDate"in o?o.toDate():new Date(String(o)),new Intl.DateTimeFormat("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}).format(c))}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[e.holes," holes • ",e.participantIds.length," players"]})]}),(0,t.jsx)(r.Badge,{variant:{pending:"warning",active:"success",completed:"default",cancelled:"error"}[e.status],children:e.status})]}),"active"===e.status&&e.currentHole&&(0,t.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-100",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Current hole"}),(0,t.jsx)("span",{className:"text-lg font-bold text-fairway-600",children:e.currentHole})]})})]})})}e.s(["MatchCard",()=>i],41566);var o=e.i(71645),c=e.i(3812);function l({value:e,onChange:a,className:r}){let[i,l]=(0,o.useState)(e);return(0,t.jsxs)("div",{className:(0,n.cn)("space-y-6",r),children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Bet Type"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[{id:"none",label:"No Bets",description:"Just track scores"},{id:"nassau",label:"Nassau",description:"Front 9, Back 9, Total"},{id:"skins",label:"Skins",description:"Win each hole"},{id:"both",label:"Nassau & Skins",description:"Both bets"}].map(e=>(0,t.jsxs)("button",{onClick:()=>{var t;let s;return s={type:t=e.id},void(("nassau"===t||"both"===t)&&(s.nassauAmount=i.nassauAmount||1,s.nassauAutoPress=i.nassauAutoPress??!0),("skins"===t||"both"===t)&&(s.skinsAmount=i.skinsAmount||1,s.skinsCarryover=i.skinsCarryover??!0),l(s),a(s))},className:(0,n.cn)("p-3 rounded-lg border-2 transition-all","text-left text-sm font-medium","tap-target",i.type===e.id?"border-fairway-600 bg-fairway-50 text-fairway-900":"border-gray-200 bg-white text-gray-900 hover:border-gray-300"),children:[(0,t.jsx)("div",{className:"font-semibold",children:e.label}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:e.description})]},e.id))})]}),("nassau"===i.type||"both"===i.type)&&(0,t.jsxs)(s.Card,{variant:"outlined",className:"p-4 space-y-4",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900",children:"Nassau Settings"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bet Amount per 9"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-lg text-fairway-600",children:"$"}),(0,t.jsx)(c.Input,{type:"number",step:.5,min:.5,value:i.nassauAmount?.toString()||"1",onChange:e=>{var t;let s;return t=parseFloat(e.target.value)||1,void(l(s={...i,nassauAmount:Math.max(.5,t)}),a(s))},placeholder:"1.00"})]})]}),(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer tap-target p-2 rounded-lg hover:bg-gray-50",children:[(0,t.jsx)("input",{type:"checkbox",checked:i.nassauAutoPress??!0,onChange:()=>{let e={...i,nassauAutoPress:!i.nassauAutoPress};l(e),a(e)},className:"w-6 h-6 rounded cursor-pointer"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:"Auto-press"}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"Automatically start a new bet if winner"})]})]})]}),("skins"===i.type||"both"===i.type)&&(0,t.jsxs)(s.Card,{variant:"outlined",className:"p-4 space-y-4",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900",children:"Skins Settings"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bet Amount per Skin"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-lg text-fairway-600",children:"$"}),(0,t.jsx)(c.Input,{type:"number",step:.5,min:.5,value:i.skinsAmount?.toString()||"1",onChange:e=>{var t;let s;return t=parseFloat(e.target.value)||1,void(l(s={...i,skinsAmount:Math.max(.5,t)}),a(s))},placeholder:"1.00"})]})]}),(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer tap-target p-2 rounded-lg hover:bg-gray-50",children:[(0,t.jsx)("input",{type:"checkbox",checked:i.skinsCarryover??!0,onChange:()=>{let e={...i,skinsCarryover:!i.skinsCarryover};l(e),a(e)},className:"w-6 h-6 rounded cursor-pointer"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:"Carryover"}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"Unclaimed skins carry over to next hole"})]})]})]}),"none"!==i.type&&(0,t.jsx)(s.Card,{variant:"elevated",className:"p-4 bg-fairway-50",children:(0,t.jsxs)("div",{className:"text-sm text-fairway-900",children:["nassau"===i.type&&(0,t.jsxs)("div",{children:["Nassau: $",i.nassauAmount,"/9 holes",i.nassauAutoPress&&" • Auto-press enabled"]}),"skins"===i.type&&(0,t.jsxs)("div",{children:["Skins: $",i.skinsAmount,"/hole",i.skinsCarryover&&" • Carryover enabled"]}),"both"===i.type&&(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{children:["Nassau: $",i.nassauAmount,"/9",i.nassauAutoPress&&" (auto-press)"]}),(0,t.jsxs)("div",{children:["Skins: $",i.skinsAmount,"/hole",i.skinsCarryover&&" (carryover)"]})]})]})})]})}var d=e.i(18566),u=e.i(59544),m=e.i(54338),h=e.i(34051);e.i(36180);var p=e.i(98925),x=e.i(75076);async function g(e,t,a){let s=new Date,r=`bet_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,n={id:r,type:a.type,unitValue:a.unitValue,scoringMode:a.scoringMode,nassauConfig:a.nassauConfig??null,skinsConfig:a.skinsConfig??null,createdAt:s,createdBy:t};try{return await (0,p.setDoc)((0,x.betDoc)(e,r),n),n}catch(e){throw console.error("Error creating bet:",e),e}}function y(){let e=(0,d.useRouter)(),{user:a}=(0,m.useAuth)(),[r,i]=(0,o.useState)("course"),[p,x]=(0,o.useState)(!1),[y,f]=(0,o.useState)(null),[v,b]=(0,o.useState)({courseName:"",teeTime:new Date().toISOString().slice(0,16),holes:18,betConfig:{type:"nassau",nassauAmount:1,nassauAutoPress:!0}}),A=["course","datetime","bets","confirm"],j=A.indexOf(r),N=j===A.length-1,w=async()=>{if(a){x(!0),f(null);try{let t={courseName:v.courseName,teeTime:new Date(v.teeTime),holes:v.holes},s=(await (0,h.createMatch)(a.id,t)).id;("nassau"===v.betConfig.type||"both"===v.betConfig.type)&&await g(s,a.id,{type:"nassau",unitValue:v.betConfig.nassauAmount||1,scoringMode:"gross",nassauConfig:{frontAmount:v.betConfig.nassauAmount||1,backAmount:v.betConfig.nassauAmount||1,overallAmount:v.betConfig.nassauAmount||1,autoPress:v.betConfig.nassauAutoPress??!0,pressTrigger:1,maxPresses:3}}),("skins"===v.betConfig.type||"both"===v.betConfig.type)&&await g(s,a.id,{type:"skins",unitValue:v.betConfig.skinsAmount||1,scoringMode:"gross",skinsConfig:{skinValue:v.betConfig.skinsAmount||1,carryover:v.betConfig.skinsCarryover??!0,validation:!0}}),e.push(`/match/${s}`)}catch(e){console.error("Failed to create match:",e),f(e instanceof Error?e.message:"Failed to create match")}finally{x(!1)}}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex justify-between items-center gap-1",children:A.map((e,a)=>(0,t.jsx)("div",{className:(0,n.cn)("flex-1 h-2 rounded-full transition-colors",a<=j?"bg-fairway-600":"bg-gray-200")},e))}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Step ",j+1," of ",A.length,": ",{course:"Course",datetime:"When & How Many",bets:"Bets",confirm:"Review"}[r]]})]}),y&&(0,t.jsx)(s.Card,{variant:"outlined",className:"bg-red-50 border-red-200 p-4",children:(0,t.jsx)("p",{className:"text-red-700 text-sm",children:y})}),(0,t.jsxs)("div",{className:"space-y-4",children:["course"===r&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Course Name"}),(0,t.jsx)(c.Input,{type:"text",placeholder:"e.g., Pebble Beach, Local GC",value:v.courseName,onChange:e=>b({...v,courseName:e.target.value}),autoFocus:!0}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Where are you playing today?"})]}),"datetime"===r&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Tee Time"}),(0,t.jsx)(c.Input,{type:"datetime-local",value:v.teeTime,onChange:e=>b({...v,teeTime:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Holes"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[9,18].map(e=>(0,t.jsxs)("button",{onClick:()=>b({...v,holes:e}),className:(0,n.cn)("p-3 rounded-lg border-2 font-semibold transition-all","tap-target",v.holes===e?"border-fairway-600 bg-fairway-50 text-fairway-900":"border-gray-200 bg-white text-gray-900 hover:border-gray-300"),children:[e," Holes"]},e))})]})]}),"bets"===r&&(0,t.jsx)(l,{value:v.betConfig,onChange:e=>b({...v,betConfig:e})}),"confirm"===r&&(0,t.jsxs)(s.Card,{variant:"elevated",className:"p-6 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg text-gray-900",children:"Match Summary"}),(0,t.jsxs)("div",{className:"space-y-3 bg-gray-50 p-4 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Course"}),(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:v.courseName})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Tee Time"}),(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:new Date(v.teeTime).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Format"}),(0,t.jsxs)("span",{className:"font-semibold text-gray-900",children:[v.holes," Holes"]})]}),(0,t.jsxs)("div",{className:"border-t border-gray-200 pt-3 flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Bet Type"}),(0,t.jsx)("span",{className:"font-semibold text-fairway-600",children:"none"===v.betConfig.type?"No Bets":"nassau"===v.betConfig.type?"Nassau":"skins"===v.betConfig.type?"Skins":"Nassau & Skins"})]})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"You can invite other players after creating the match."})]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(u.Button,{variant:"secondary",onClick:()=>{j>0&&(i(A[j-1]),f(null))},disabled:0===j||p,fullWidth:!0,children:"Back"}),N?(0,t.jsx)(u.Button,{onClick:w,loading:p,disabled:p,fullWidth:!0,children:"Create Match"}):(0,t.jsx)(u.Button,{onClick:()=>{j<A.length-1&&(i(A[j+1]),f(null))},disabled:!(()=>{switch(r){case"course":return v.courseName.trim().length>0;case"datetime":return v.teeTime.length>0;case"bets":case"confirm":return!0;default:return!1}})()||p,fullWidth:!0,children:"Next"})]})]})}e.s(["CreateMatchWizard",()=>y],33330),e.s([],94968)},50561,e=>{"use strict";var t=e.i(43476);e.i(84004);var a=e.i(66085),s=e.i(3374);e.i(94968);var r=e.i(33330);e.i(64649);var n=e.i(48010);function i(){return(0,t.jsx)(n.ProtectedRoute,{children:(0,t.jsxs)(a.Screen,{padBottom:!0,children:[(0,t.jsx)(s.Header,{title:"New Match",subtitle:"Set up a golf match and configure bets"}),(0,t.jsx)("div",{className:"p-4 pb-24",children:(0,t.jsx)(r.CreateMatchWizard,{})})]})})}e.s(["default",()=>i])}]);