(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54338,75076,50136,e=>{"use strict";let t;var r=e.i(71645);e.i(51718);var a=e.i(18357),s=e.i(59141);e.i(36180);var c=e.i(98925);let i={toFirestore:e=>({...e,createdAt:c.Timestamp.fromDate(e.createdAt),updatedAt:c.Timestamp.fromDate(e.updatedAt),lastActiveAt:c.Timestamp.fromDate(e.lastActiveAt)}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate(),lastActiveAt:t.lastActiveAt.toDate()}}},n={toFirestore:e=>({...e,createdAt:c.Timestamp.fromDate(e.createdAt),updatedAt:c.Timestamp.fromDate(e.updatedAt),startedAt:e.startedAt?c.Timestamp.fromDate(e.startedAt):null,completedAt:e.completedAt?c.Timestamp.fromDate(e.completedAt):null,teeTime:c.Timestamp.fromDate(e.teeTime)}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate(),startedAt:t.startedAt?.toDate()??null,completedAt:t.completedAt?.toDate()??null,teeTime:t.teeTime.toDate()}}},l={toFirestore:e=>({...e,invitedAt:c.Timestamp.fromDate(e.invitedAt),confirmedAt:e.confirmedAt?c.Timestamp.fromDate(e.confirmedAt):null}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,invitedAt:t.invitedAt.toDate(),confirmedAt:t.confirmedAt?.toDate()??null}}},o={toFirestore:e=>({...e,createdAt:c.Timestamp.fromDate(e.createdAt),updatedAt:c.Timestamp.fromDate(e.updatedAt),syncedAt:e.syncedAt?c.Timestamp.fromDate(e.syncedAt):null}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate(),syncedAt:t.syncedAt?.toDate()??null}}},d={toFirestore:e=>({...e,createdAt:c.Timestamp.fromDate(e.createdAt)}),fromFirestore:e=>{let t=e.data();return{...t,id:e.id,createdAt:t.createdAt.toDate()}}};function u(){return t||(t=(0,c.getFirestore)()),t}let m=e=>(0,c.doc)((0,c.collection)(u(),"users"),e).withConverter(i);async function h(e){try{let t=await (0,c.getDoc)(m(e));return t.exists()?t.data():null}catch(e){throw console.error("Error fetching user:",e),e}}async function p(e,t){let r=new Date,a={id:e,displayName:t.displayName,email:t.email,avatarUrl:null,handicapIndex:null,homeClub:null,defaultTeeBox:"blue",notificationsEnabled:!0,createdAt:r,updatedAt:r,lastActiveAt:r};try{return await (0,c.setDoc)(m(e),a),a}catch(e){throw console.error("Error creating user:",e),e}}async function x(e,t){try{await (0,c.updateDoc)(m(e),{...t,updatedAt:new Date})}catch(e){throw console.error("Error updating user:",e),e}}async function f(e){try{await (0,c.updateDoc)(m(e),{lastActiveAt:new Date})}catch(e){throw console.error("Error updating user activity:",e),e}}function A(){let[e,t]=(0,r.useState)(null),[c,i]=(0,r.useState)(null),[n,l]=(0,r.useState)(!0),[o,d]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=(0,a.onAuthStateChanged)(s.auth,async e=>{try{if(t(e),e){let t=await h(e.uid);if(t)await f(e.uid);else{let r=e.displayName||e.email||"User",a=e.email||"";t=await p(e.uid,{displayName:r,email:a})}i(t),d(null)}else i(null),d(null);l(!1)}catch(e){d(e instanceof Error?e:Error("Unknown auth error")),l(!1)}});return()=>e()},[]),{firebaseUser:e,user:c,loading:n,error:o}}e.s(["betDoc",0,(e,t)=>(0,c.doc)((0,c.collection)(u(),`matches/${e}/bets`),t).withConverter(d),"matchDoc",0,e=>(0,c.doc)((0,c.collection)(u(),"matches"),e).withConverter(n),"matchesCollection",0,()=>(0,c.collection)(u(),"matches").withConverter(n),"participantsCollection",0,e=>(0,c.collection)(u(),`matches/${e}/participants`).withConverter(l),"scoreDoc",0,(e,t)=>(0,c.doc)((0,c.collection)(u(),`matches/${e}/scores`),t).withConverter(o),"scoresCollection",0,e=>(0,c.collection)(u(),`matches/${e}/scores`).withConverter(o),"userDoc",0,m],75076),e.s(["createUser",()=>p,"getUser",()=>h,"updateUser",()=>x,"updateUserActivity",()=>f],50136),e.s(["useAuth",()=>A],54338)},64649,48010,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(18566),s=e.i(54338);e.i(84004);var c=e.i(66085);function i({children:e}){let{user:i,loading:n}=(0,s.useAuth)(),l=(0,a.useRouter)();return((0,r.useEffect)(()=>{n||i||l.push("/login")},[i,n,l]),n)?(0,t.jsx)(c.Screen,{className:"flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin text-4xl mb-4",children:"â›³"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Loading..."})]})}):i?(0,t.jsx)(t.Fragment,{children:e}):null}e.s(["ProtectedRoute",()=>i],48010),e.s([],64649)},34051,e=>{"use strict";e.i(36180);var t=e.i(98925),r=e.i(75076);async function a(e){try{let a=await (0,t.getDoc)((0,r.matchDoc)(e));return a.exists()?a.data():null}catch(e){throw console.error("Error fetching match:",e),e}}async function s(e,a){try{let s=(0,t.query)((0,r.matchesCollection)(),(0,t.where)("participantIds","array-contains",e)),c=(await (0,t.getDocs)(s)).docs.map(e=>e.data());return a&&(c=c.filter(e=>e.status===a)),c.sort((e,t)=>t.teeTime.getTime()-e.teeTime.getTime())}catch(e){throw console.error("Error fetching user matches:",e),e}}async function c(e,a){let s=new Date,c=`match_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:c,courseName:a.courseName,courseId:a.courseId||null,teeTime:a.teeTime,holes:a.holes||18,status:"pending",currentHole:null,createdBy:e,scorerId:e,participantIds:[e],createdAt:s,updatedAt:s,startedAt:null,completedAt:null,version:1};try{return await (0,t.setDoc)((0,r.matchDoc)(c),i),i}catch(e){throw console.error("Error creating match:",e),e}}async function i(e,a){try{let s={status:a,updatedAt:new Date};"active"===a?s.startedAt=new Date:"completed"===a&&(s.completedAt=new Date),await (0,t.updateDoc)((0,r.matchDoc)(e),s)}catch(e){throw console.error("Error updating match status:",e),e}}e.s(["createMatch",()=>c,"getMatch",()=>a,"getUserMatches",()=>s,"updateMatchStatus",()=>i])},24483,e=>{"use strict";var t=e.i(71645);e.i(36180);var r=e.i(98925),a=e.i(75076),s=e.i(34051);function c(e){let[c,i]=(0,t.useState)(null),[n,l]=(0,t.useState)([]),[o,d]=(0,t.useState)(!0),[u,m]=(0,t.useState)(null);return(0,t.useEffect)(()=>{if(!e)return;let t=null,c=null;return(async()=>{try{if(!await (0,s.getMatch)(e)){m(Error("Match not found")),d(!1);return}t=(0,r.onSnapshot)((0,a.matchDoc)(e),e=>{e.exists()?(i(e.data()),m(null)):m(Error("Match was deleted"))}),c=(0,r.onSnapshot)((0,a.participantsCollection)(e),e=>{let t=e.docs.map(e=>e.data());l(t),d(!1)},e=>{console.error("Error subscribing to participants:",e),m(e instanceof Error?e:Error("Unknown error")),d(!1)})}catch(e){m(e instanceof Error?e:Error("Unknown error")),d(!1)}})(),()=>{t?.(),c?.()}},[e]),{match:c,participants:n,loading:o,error:u}}e.s(["useMatch",()=>c])},30712,e=>{"use strict";var t=e.i(43476),r=e.i(22016);e.i(84004);var a=e.i(66085),s=e.i(3374);e.i(16787);var c=e.i(39964),i=e.i(59544),n=e.i(96640);e.i(64649);var l=e.i(48010),o=e.i(24483);function d({params:e}){let d=e.id,{match:u,loading:m,error:h}=(0,o.useMatch)(d),p=u?.participantIds||[];return m?(0,t.jsx)(l.ProtectedRoute,{children:(0,t.jsxs)(a.Screen,{children:[(0,t.jsx)(s.Header,{title:"Match Details"}),(0,t.jsx)("div",{className:"p-4 flex items-center justify-center h-96",children:(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("div",{className:"animate-spin text-4xl",children:"â›³"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Loading match..."})]})})]})}):h||!u?(0,t.jsx)(l.ProtectedRoute,{children:(0,t.jsxs)(a.Screen,{children:[(0,t.jsx)(s.Header,{title:"Match Details"}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(c.Card,{variant:"outlined",className:"bg-red-50 border-red-200",children:(0,t.jsx)("p",{className:"text-red-700 text-sm",children:"string"==typeof h?h:"Match not found"})})})]})}):(0,t.jsx)(l.ProtectedRoute,{children:(0,t.jsxs)(a.Screen,{padBottom:!0,children:[(0,t.jsx)(s.Header,{title:u.courseName,subtitle:"Match Details"}),(0,t.jsxs)("div",{className:"p-4 pb-24 space-y-6",children:[(0,t.jsxs)(c.Card,{variant:"elevated",className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:u.courseName}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:new Date(u.teeTime instanceof Date?u.teeTime:"object"==typeof u.teeTime&&null!==u.teeTime&&"toDate"in u.teeTime?u.teeTime.toDate():new Date(String(u.teeTime))).toLocaleString("en-US",{weekday:"long",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]}),(0,t.jsx)(n.Badge,{variant:{pending:"warning",active:"success",completed:"default",cancelled:"error"}[u.status]||"default",children:u.status})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-200",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600 uppercase font-semibold",children:"Format"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-gray-900",children:[u.holes," Holes"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600 uppercase font-semibold",children:"Players"}),(0,t.jsx)("p",{className:"text-lg font-bold text-gray-900",children:p.length})]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Players"}),(0,t.jsx)("div",{className:"space-y-2",children:p.length>0?p.map(e=>(0,t.jsx)(c.Card,{variant:"outlined",className:"p-3",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-fairway-100 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-lg",children:"ðŸ‘¤"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:"Player"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e})]})]})})},e)):(0,t.jsx)(c.Card,{variant:"outlined",className:"p-4 text-center",children:(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"No players added yet"})})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:["pending"===u.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.default,{href:`/match/${d}`,className:"block",children:(0,t.jsx)(i.Button,{fullWidth:!0,children:"Start Scoring"})}),(0,t.jsx)(i.Button,{variant:"secondary",fullWidth:!0,children:"Invite Players"})]}),"active"===u.status&&(0,t.jsx)(r.default,{href:`/match/${d}/scorecard`,className:"block",children:(0,t.jsx)(i.Button,{fullWidth:!0,children:"Enter Scores"})}),"completed"===u.status&&(0,t.jsx)(r.default,{href:`/match/${d}/results`,className:"block",children:(0,t.jsx)(i.Button,{fullWidth:!0,children:"View Results"})})]})]})]})})}e.s(["default",()=>d])}]);